(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7f3e8d5a"],{1276:function(t,e,l){"use strict";var c=l("d784"),n=l("44e7"),i=l("825a"),s=l("1d80"),a=l("4840"),o=l("8aa5"),r=l("50c4"),d=l("577e"),u=l("14c3"),b=l("9263"),f=l("9f7f"),p=l("d039"),j=f.UNSUPPORTED_Y,O=[].push,g=Math.min,v=4294967295,m=!p((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var l="ab".split(t);return 2!==l.length||"a"!==l[0]||"b"!==l[1]}));c("split",(function(t,e,l){var c;return c="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,l){var c=d(s(this)),i=void 0===l?v:l>>>0;if(0===i)return[];if(void 0===t)return[c];if(!n(t))return e.call(c,t,i);var a,o,r,u=[],f=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),p=0,j=new RegExp(t.source,f+"g");while(a=b.call(j,c)){if(o=j.lastIndex,o>p&&(u.push(c.slice(p,a.index)),a.length>1&&a.index<c.length&&O.apply(u,a.slice(1)),r=a[0].length,p=o,u.length>=i))break;j.lastIndex===a.index&&j.lastIndex++}return p===c.length?!r&&j.test("")||u.push(""):u.push(c.slice(p)),u.length>i?u.slice(0,i):u}:"0".split(void 0,0).length?function(t,l){return void 0===t&&0===l?[]:e.call(this,t,l)}:e,[function(e,l){var n=s(this),i=void 0==e?void 0:e[t];return void 0!==i?i.call(e,n,l):c.call(d(n),e,l)},function(t,n){var s=i(this),b=d(t),f=l(c,s,b,n,c!==e);if(f.done)return f.value;var p=a(s,RegExp),O=s.unicode,m=(s.ignoreCase?"i":"")+(s.multiline?"m":"")+(s.unicode?"u":"")+(j?"g":"y"),h=new p(j?"^(?:"+s.source+")":s,m),y=void 0===n?v:n>>>0;if(0===y)return[];if(0===b.length)return null===u(h,b)?[b]:[];var x=0,w=0,k=[];while(w<b.length){h.lastIndex=j?0:w;var _,C=u(h,j?b.slice(w):b);if(null===C||(_=g(r(h.lastIndex+(j?w:0)),b.length))===x)w=o(b,w,O);else{if(k.push(b.slice(x,w)),k.length===y)return k;for(var T=1;T<=C.length-1;T++)if(k.push(C[T]),k.length===y)return k;w=x=_}}return k.push(b.slice(x)),k}]}),!m,j)},"6ab7":function(t,e,l){"use strict";l.r(e);l("a4d3"),l("e01a"),l("b0c0");var c=l("7a23"),n=l("e8b3"),i=l.n(n),s=l("4d26"),a=l.n(s),o=l("00ef"),r=l.n(o),d={key:0},u={class:"_detail container-fluid mb-3"},b={class:"row d-flex justify-content-around "},f={class:"pl-2 pb-2 pl-md-3 pl-lg-4 d-flex align-items-center "},p=Object(c["q"])("首页"),j=Object(c["q"])("商品详情"),O={class:"col-12 col-sm-6 col-md-5 col-lg-4 card card-body\r\n                        d-flex justify-content-center align-items-center ",id:"_loadImg"},g=["src"],v={key:1},m=Object(c["n"])("div",{class:"image-slot d-flex flex-column justify-content-center"},[Object(c["n"])("i",{class:"el-icon-picture-outline"}),Object(c["n"])("span",{class:"loadFail"},"加载失败")],-1),h={class:"col-12 col-sm-6 col-md-7 col-lg-8 card card-body  "},y={class:"d-flex flex-column justify-content-between "},x={class:"txt-subtitle  py-2 align-self-start d-flex flex-row justify-content-start",style:{"font-weight":"bold"}},w={class:"d-inline  ",style:{"text-align":"left"}},k={class:"py-1 py-sm-2  align-self-start "},_=Object(c["q"])(" 券后价： "),C={class:"txt-subtitle",style:{color:"red"}},T={class:"txt-mini text-muted px-2"},M=Object(c["q"])(" 原价 "),P=Object(c["p"])('<div class="py-1 py-sm-2  align-self-start"> 优惠券： <span class="txt-subbody bg-danger border border-danger text-white py-0 px-1 ">2元券</span><span class="txt-subbody border border-danger text-danger  py-0 px-1 mx-1">剩900张</span></div><div class="py-1 py-sm-2  align-self-start"> 款式： <span class="txt-subbody border border-danger text-danger  p-2">标准款式</span></div>',2),R={class:"py-1 py-sm-2  align-self-start"},I=Object(c["q"])(" 库存： "),E={class:"txt-subbody "},q={class:"pt-3 align-self-end"},A={class:"d-flex justify-content-end align-items-center",style:{"font-size":"1.5rem"}},S=Object(c["n"])("div",{class:"txt-subbody mt-2"},"收藏：",-1),V={class:" "},B={key:0,src:i.a,style:{"max-width":"26px"},alt:""},Z={key:1,src:a.a,style:{"max-width":"26px"},alt:""},Q=Object(c["p"])('<div class="col-12 col-sm-3 col-md-3 pt-3 px-0"><div class="d-none d-sm-block"><ul class="txt-subbody list-group"><li class="list-group-item " style="background:#f4f4f4;font-weight:bold;">书小狸图书用品店</li><li class="list-group-item border-top-0 border-bottom-0 ">描述相符：高</li><li class="list-group-item border-top-0 border-bottom-0">描述相符：高</li><li class="list-group-item border-top-0 ">描述相符：高</li></ul></div><div class="d-block d-sm-none"><ul class="txt-subbody list-unstyled "><li class="py-1" style="background:#f4f4f4;font-weight:bold;">书小狸图书用品店</li><li class="d-flex pt-1 justify-content-start "><span class="px-3">描述相符：高</span><span class="px-3">描述相符：高</span><span class="px-3">描述相符：高</span></li></ul></div></div>',1),z={class:"col-12 col-sm-9 col-md-9  px-0 pt-3"},D={class:" card card-body px-0 pt-0"},U={class:"_list_title txt-body list-unstyled d-flex justify-content-start"},F={class:"_list_body txt-subbody list-unstyled"},J=["innerHTML"],L={key:1},N=["src"],H={key:0,class:""},Y={class:"pt-1 pb-0 d-flex justify-content-start align-items-center"},$={class:"d-flex justify-content-center align-items-center border border-success rounded rounded-circle",style:{width:"60px",height:"60px",background:"#f5f2f0",overflow:"hidden"}},G=["src"],K={class:"txt-body px-2 ",style:{"font-weight":"bold",color:"#1f1f1f"}},W={class:"pt-1 pb-2 px-3"},X=Object(c["n"])("div",{class:"txt-mini text-muted ",style:{float:"left"}},[Object(c["n"])("span",null,"款式：标准款式")],-1),tt={class:"px-3 txt-mini text-muted d-flex justify-content-start"},et=Object(c["q"])(" 评分： "),lt={class:"py-1 px-1"},ct={class:"txt-subbody"},nt={key:1},it={key:1},st=Object(c["n"])("img",{src:r.a,alt:""},null,-1),at=[st],ot={id:"_result"},rt=Object(c["q"])("返回");function dt(t,e,l,n,i,s){var a=Object(c["V"])("el-breadcrumb-item"),o=Object(c["V"])("el-breadcrumb"),r=Object(c["V"])("el-image"),st=Object(c["V"])("el-rate"),dt=Object(c["V"])("el-button"),ut=Object(c["V"])("el-result");return Object(c["M"])(),Object(c["m"])(c["b"],null,[n.appearError?(Object(c["M"])(),Object(c["m"])("div",it,at)):(Object(c["M"])(),Object(c["m"])("div",d,[Object(c["n"])("div",u,[Object(c["n"])("div",b,[Object(c["n"])("div",f,[Object(c["r"])(o,{"separator-class":"el-icon-arrow-right"},{default:Object(c["lb"])((function(){return[Object(c["r"])(a,{to:{path:"/"}},{default:Object(c["lb"])((function(){return[p]})),_:1}),n.lastPage.length>0?(Object(c["M"])(),Object(c["k"])(a,{key:0,onClick:e[0]||(e[0]=function(e){return t.$router.push({path:n.lastPagePath,query:n.lastPageQuery||{}})})},{default:Object(c["lb"])((function(){return[Object(c["q"])(Object(c["Z"])(n.lastPage),1)]})),_:1})):Object(c["l"])("",!0),Object(c["r"])(a,null,{default:Object(c["lb"])((function(){return[j]})),_:1})]})),_:1})]),Object(c["n"])("div",O,[n.initBooks?(Object(c["M"])(),Object(c["m"])("img",{key:0,src:t.detail.cover_url,alt:"",class:"img-fluid img-thumbnail",style:{width:"300px"}},null,8,g)):(Object(c["M"])(),Object(c["m"])("div",v,[Object(c["r"])(r,null,{error:Object(c["lb"])((function(){return[m]})),_:1})]))]),Object(c["n"])("div",h,[Object(c["n"])("div",y,[Object(c["n"])("div",x,[Object(c["n"])("span",w,Object(c["Z"])(t.detail.title+" "+t.detail.description),1)]),Object(c["n"])("div",k,[_,Object(c["n"])("span",C,"￥ "+Object(c["Z"])(t.detail.price)+".00",1),Object(c["n"])("span",T,[M,Object(c["n"])("s",null,Object(c["Z"])(t.detail.price-2)+".00",1)])]),P,Object(c["n"])("div",R,[I,Object(c["n"])("span",E,Object(c["Z"])(t.detail.stock)+"件",1)]),Object(c["n"])("div",q,[Object(c["n"])("div",A,[Object(c["n"])("div",{class:" d-flex justify-content-center align-items-center  text-muted",onClick:e[1]||(e[1]=function(e){return n.collectBook(t.collection[0].id)})},[S,Object(c["n"])("div",V,[t.collection[0].isCollect?(Object(c["M"])(),Object(c["m"])("img",B)):(Object(c["M"])(),Object(c["m"])("img",Z))])]),Object(c["n"])("button",{class:" btn border border-danger  text-white mx-2",style:{background:"#FF976A","font-size":"0.8rem"},onClick:e[2]||(e[2]=function(){return n.handleAddCart&&n.handleAddCart.apply(n,arguments)})},"加入购物车 "),Object(c["n"])("button",{class:" btn border border-danger  bg-danger text-white mx-2",style:{"font-size":"0.8rem"},onClick:e[3]||(e[3]=function(){return n.goToCart&&n.goToCart.apply(n,arguments)})},"  立即购买  ")])])])]),Q,Object(c["n"])("div",z,[Object(c["n"])("div",D,[Object(c["n"])("ul",U,[Object(c["n"])("li",{class:Object(c["B"])(["d-inline-block mx-5 py-1 px-3",{active:n.activeTitle}]),onClick:e[4]||(e[4]=function(){return n.changeActive&&n.changeActive.apply(n,arguments)})},"商品详情 ",2),Object(c["n"])("li",{class:Object(c["B"])(["d-inline-block py-1 px-3",{active:!n.activeTitle}]),onClick:e[5]||(e[5]=function(){return n.changeActive&&n.changeActive.apply(n,arguments)})}," 用户评价 ",2)]),Object(c["n"])("ul",F,[Object(c["n"])("li",{class:Object(c["B"])(["",{active:n.activeTitle}])},[t.like_goods.length?(Object(c["M"])(),Object(c["m"])("div",{key:0,id:"_parse_html",innerHTML:n.bookDetails},null,8,J)):(Object(c["M"])(),Object(c["m"])("div",L," 暂无商品详情数据 ")),Object(c["n"])("img",{src:t.detail.cover_url,alt:"",class:"img-fluid img-thumbnail",style:{width:"300px"}},null,8,N)],2),Object(c["n"])("li",{class:Object(c["B"])(["",{active:!n.activeTitle}])},[n.showComments.length?(Object(c["M"])(),Object(c["m"])("div",H,[(Object(c["M"])(!0),Object(c["m"])(c["b"],null,Object(c["T"])(t.detail.comments,(function(t){return Object(c["M"])(),Object(c["m"])("div",{key:t.id,class:"mt-2 px-4 py-2  d-flex flex-column justify-content-between align-items-start",style:{"border-bottom":"5px solid pink"}},[Object(c["n"])("div",Y,[Object(c["n"])("div",$,[Object(c["n"])("img",{src:t.user.avatar_url,alt:"",class:"img-fluid  ",style:{width:"56px",height:"auto"}},null,8,G)]),Object(c["n"])("span",K,Object(c["Z"])(t.user.name),1)]),Object(c["n"])("div",W,[X,Object(c["n"])("div",tt,[et,Object(c["r"])(st,{modelValue:t.rate,"onUpdate:modelValue":function(e){return t.rate=e},disabled:"","show-score":"","text-color":"#ff9900",style:{"line-height":"0.5"}},null,8,["modelValue","onUpdate:modelValue"])])]),Object(c["n"])("div",lt,[Object(c["n"])("span",ct,Object(c["Z"])(t.content),1)])])})),128))])):(Object(c["M"])(),Object(c["m"])("div",nt," 暂无评论 "))],2)])])])])])])),Object(c["n"])("div",ot,[Object(c["r"])(ut,{icon:n.hintSign,title:n.hintSignName,subTitle:"请根据提示进行操作"},{extra:Object(c["lb"])((function(){return[Object(c["r"])(dt,{type:"primary",size:"medium",onClick:n.cancelOverflow},{default:Object(c["lb"])((function(){return[rt]})),_:1},8,["onClick"])]})),_:1},8,["icon","title"])])],64)}var ut=l("5530"),bt=(l("ac1f"),l("1276"),l("159b"),l("99af"),l("b64b"),l("1157")),ft=l.n(bt),pt=l("5a79"),jt=l("4995"),Ot=l("5a07"),gt=l("1bab");function vt(t){return Object(gt["a"])({url:"/api/goods/"+t})}var mt=l("55a0"),ht=l("5502"),yt=l("6c02"),xt={name:"Detail",components:{},setup:function(){var t=Object(yt["c"])(),e=Object(yt["d"])(),l=Object(ht["b"])(),n=Object(c["R"])(!1),i=Object(c["R"])(!0),s=Object(c["Q"])({collect:[],collection:[{id:0,isCollect:!1}]}),a=Object(c["R"])(0),o=Object(c["R"])(!0),r=Object(c["Q"])({detail:{title:"",description:"",price:0},like_goods:[]}),d=Object(c["R"])(0),u=Object(c["R"])(["error","success"]),b=Object(c["R"])(["操作失败","操作成功"]),f=Object(c["R"])(""),p=Object(c["R"])(""),j=Object(c["R"])([]),O=Object(c["R"])(""),g=Object(c["R"])(""),v=Object(c["R"])({});a.value=t.query.id,Object(c["J"])((function(){console.log("当前的id是",a.value);var t=pt["a"].service({fullscreen:!1,text:"图片加载中",target:"#_loadImg"});vt(a.value).then((function(t){if(r.detail=t.goods,r.like_goods=t.like_goods,console.log("detail-data",t),r.detail.cover_url&&0!==r.detail.cover_url.length||(i.value=!1,r.detail.title="网络出错啦！请重试"),p.value=r.detail.details,j.value=r.detail.comments,f.value=p.value,window.localStorage.getItem("lastPage").length>0){O.value=window.localStorage.getItem("lastPage"),g.value=window.localStorage.getItem("lastPagePath");var e=window.localStorage.getItem("lastPageQuery");if(e.length>0){var l=e.split("?");e=l[l.length-1];var c=new Object;e.split("&").forEach((function(t){var e=t.split("=");c[e[0]]=e[e.length-1]})),v.value=c}}m()})).catch((function(t){console.log("detail-err",t),jt["a"].error("获取商品数据失败")})),null!==t&&(t.close(),t=null)})),ft()(window).scroll((function(){var t=ft()(document).scrollTop();ft()("#_result").css("top",t)}));var m=function(){Object(mt["b"])(0).then((function(t){console.log("detail-collection-data",t),s.collect=s.collect.concat(t.data),h()})).catch((function(t){console.log("detail-collection-err",t),jt["a"].error("获取收藏数据错误")}))},h=function(){Object.keys(r.detail).length>0?s.collect.forEach((function(t,e){s.collection[0].id=r.detail.id,s.collection[0].isCollect=!1,r.detail.id==t.goods.id&&(s.collection[0].isCollect=!0)})):console.log("当前商品数据为空")},y=function(){o.value=!o.value},x=function(){d.value=1,Object(Ot["a"])({goods_id:r.detail.id,num:1}).then((function(t){201!==t.status&&204!==t.status||(ft()("#_result").css("display","flex"),ft()("body").css("overflow","hidden"),setTimeout((function(){ft()("#_result").css("display","none"),ft()("body").css("overflow",""),l.dispatch("updateCart")}),1e3))})).catch((function(t){console.log("detail-addcart-err",t),d.value=0,ft()("#_result").css("display","flex"),ft()("body").css("overflow","hidden"),setTimeout((function(){ft()("#_result").css("display","none"),ft()("body").css("overflow","")}),1e3)}))},w=function(){d.value=1,Object(Ot["a"])({goods_id:r.detail.id,num:1}).then((function(t){201!==t.status&&204!==t.status||(jt["a"].warning("即将跳转购物车页面"),setTimeout((function(){e.push({path:"/shopcart"})}),500))})).catch((function(t){d.value=0,ft()("#_result").css("display","flex"),ft()("body").css("overflow","hidden"),setTimeout((function(){ft()("#_result").css("display","none"),ft()("body").css("overflow","")}),1e3)}))},k=function(){ft()("#_result").css("display","none"),ft()("body").css("overflow","")},_=Object(c["i"])((function(){return u.value[d.value]})),C=Object(c["i"])((function(){return b.value[d.value]})),T=function(t){Object(mt["a"])(t).then((function(e){201===e.status?(jt["a"].success("已经收藏商品"),s.collection.forEach((function(e,l){e.id===t&&(e.isCollect=!0)}))):204===e.status?(jt["a"].success("已经取消收藏"),s.collection.forEach((function(e,l){e.id===t&&(e.isCollect=!1)}))):jt["a"].warning("注意：收藏商品需要登录")})).catch((function(t){console.log("detail-goodListItem-err",t),jt["a"].error("收藏错误！请重试")}))};return Object(ut["a"])(Object(ut["a"])(Object(ut["a"])({},Object(c["cb"])(r)),{},{appearError:n,activeTitle:o,changeActive:y},Object(c["cb"])(s)),{},{handleAddCart:x,goToCart:w,cancelOverflow:k,hintSign:_,hintSignName:C,bookDetails:f,showComments:j,initBooks:i,lastPage:O,lastPagePath:g,lastPageQuery:v,collectBook:T})}},wt=(l("b0f8"),l("d959")),kt=l.n(wt);const _t=kt()(xt,[["render",dt]]);e["default"]=_t},"99af":function(t,e,l){"use strict";var c=l("23e7"),n=l("d039"),i=l("e8b5"),s=l("861d"),a=l("7b0b"),o=l("50c4"),r=l("8418"),d=l("65f0"),u=l("1dde"),b=l("b622"),f=l("2d00"),p=b("isConcatSpreadable"),j=9007199254740991,O="Maximum allowed index exceeded",g=f>=51||!n((function(){var t=[];return t[p]=!1,t.concat()[0]!==t})),v=u("concat"),m=function(t){if(!s(t))return!1;var e=t[p];return void 0!==e?!!e:i(t)},h=!g||!v;c({target:"Array",proto:!0,forced:h},{concat:function(t){var e,l,c,n,i,s=a(this),u=d(s,0),b=0;for(e=-1,c=arguments.length;e<c;e++)if(i=-1===e?s:arguments[e],m(i)){if(n=o(i.length),b+n>j)throw TypeError(O);for(l=0;l<n;l++,b++)l in i&&r(u,b,i[l])}else{if(b>=j)throw TypeError(O);r(u,b++,i)}return u.length=b,u}})},b0f8:function(t,e,l){"use strict";l("bc4d")},bc4d:function(t,e,l){}}]);
//# sourceMappingURL=chunk-7f3e8d5a.703753e7.js.map