{"version":3,"sources":["webpack:///./src/views/search/Search.vue?1dae","webpack:///./src/views/search/Search.vue","webpack:///./src/views/search/Search.vue?1304"],"names":["class","style","size","src","alt","appearError","separator-class","to","$router","push","searchText","keyWord","activeName","tabClick","label","name","init_categories","showGoods","item","key","id","itemClick","body-style","cover_url","title","updated_at","price","comments_count","myHigherRate","disabled","show-score","text-color","myLowerRate","init_goods","description","isTotal","myRefresh","bTop","isShowBackTop","components","BackTop","setup","router","route","init_ok","goods","sales","page","list","isArriveBottom","t_categories","totalChildCategories","totalParentCategories","currentAssociateCategories","currentOrder","tSearchText","isTotalMesaage","loadingInstance_init","service","fullscreen","text","target","then","res","value","categories","console","log","length","forEach","children","subItem","window","localStorage","getItem","query","SearchText","dealSearchText","error","catch","err","close","toLowerCase","sign","index","arr","haveSimilar","arrT","indexOf","subIndex","tId","e","getMoreMessage","tab","props","path","newA","undefined","new_text","startsWith","decodeURIComponent","setItem","scroll","Math","ceil","document","scrollTop","height","loadingInstance","tCount","lenCategories","item_cid","data","html","off","animate","__exports__","render"],"mappings":"gHAAA,W,mFCGSA,MAAM,e,aAGEA,MAAM,mD,iBAEqC,M,iBACwB,M,GAG/DA,MAAM,0CAA0CC,MAAA,sB,GAGpDD,MAAM,0BAA0BC,MAAA,I,SAQTD,MAAM,yB,GACzBA,MAAM,+B,GACFA,MAAM,O,2BAMMC,MAAA,sB,GACID,MAAM,yF,GACDA,MAAM,sCAAsCC,MAAA,wB,GAC5CD,MAAM,qBACNC,MAAA,sB,GACDD,MAAM,Q,GACDA,MAAM,+BAA+BC,MAAA,sB,iBAA0D,M,GAC9FD,MAAM,c,EAGrB,eAAsE,MAAlEA,MAAM,+BAA+BE,KAAK,IAAID,MAAA,gB,YAC7CD,MAAM,gEACNC,MAAA,sB,GACMD,MAAM,Q,aAOPA,MAAM,0B,aAQNA,MAAM,0B,mBAW3BA,MAAM,+B,SAQPA,MAAM,yB,sBAOlB,eAA8C,OAAzCG,IAAA,IAAkCC,IAAI,I,YAA3C,G,2SAlFR,eAoFM,MApFN,EAoFM,CAnFU,EAAAC,a,iBAgFZ,eAEM,a,iBAlFN,eA+EM,SA7EF,eAOM,MAPN,EAOM,CANF,eAIgB,GAJDC,kBAAgB,uBAAqB,C,yBAChD,iBAA+D,CAA/D,eAA+D,GAA1CC,GAAI,YAAa,C,yBAAE,iBAAE,C,YAC1C,eAAuF,GAAlE,QAAK,+BAAE,EAAAC,QAAQC,KAAI,uB,0BAAwB,iBAAE,C,YAClE,eAAuD,Q,yBAAnC,iBAAc,C,8BAAZ,EAAAC,YAAU,O,gBAEpC,eAAkG,MAAlG,EAA6E,OAAI,eAAE,EAAAC,SAAO,KAG9F,eAMM,MANN,EAMM,CALF,eAIU,G,WAJQ,EAAAC,W,qDAAA,EAAAA,WAAU,IAAG,WAAW,EAAAC,U,0BACtC,iBAAqD,CAArD,eAAqD,GAAxCC,MAAM,OAAOC,KAAK,UAC/B,eAAqD,GAAxCD,MAAM,OAAOC,KAAK,UAC/B,eAA8D,GAAjDD,MAAM,OAAOC,KAAK,uB,sCAI5B,EAAAC,iB,iBAAX,eAsDM,MAtDN,EAsDM,CArDF,eAkDM,MAlDN,EAkDM,CAjDF,eA4CM,MA5CN,EA4CM,E,mBA3CF,eAuCM,2BAvCuD,EAAAC,WAAS,SAAjBC,G,wBAArD,eAuCM,OAvCDlB,MAAM,mCAA8DmB,IAAKD,EAAKE,GAC7E,QAAK,mBAAE,EAAAC,UAAUH,EAAKE,M,CACxB,eAoCU,GApCAE,aAAY,gBAAqBtB,MAAM,c,0BAC7C,iBAC6B,CAD7B,eAC6B,OADvBG,IAAKe,EAAKK,UAAWvB,MAAM,iCAC5BC,MAAA,qB,UACL,eAgCM,MAhCN,EAgCM,CA/BF,eAQM,MARN,EAQM,CAPF,eAAiG,OAAjG,EAAiG,eAAnBiB,EAAKM,OAAK,GACxF,eACuD,OADvD,EACuD,eAAxBN,EAAKO,YAAU,GAC9C,eAGM,MAHN,EAGM,CAFF,eAAqG,OAArG,EAAmE,KAAO,eAAEP,EAAKQ,MAAK,U,EACtF,eAA4D,QAA5D,EAA4D,CAAlC,eAA0B,wBAArBR,EAAKQ,MAAK,GAAI,MAAG,SAGxD,EACA,eAoBM,MApBN,EAoBM,CAlBF,eAiBQ,QAjBR,EAiBQ,CAhBAR,EAAKS,eAAc,G,iBAA/B,eAOO,UANH,eAIY,G,WAJM,EAAAC,a,qDAAA,EAAAA,aAAY,IACrBC,SAAA,GAASC,aAAA,GACTC,aAAW,UACX/B,MAAM,qB,uBAEf,eAA+D,OAA/D,EAAqC,MAAG,eAAE,EAAA4B,cAAY,O,iBAElD,eAOD,UANH,eAIY,G,WAJM,EAAAI,Y,qDAAA,EAAAA,YAAW,IACpBH,SAAA,GAASC,aAAA,GACTC,aAAW,UACX/B,MAAM,qB,uBAEf,eAA+D,OAA/D,EAAqC,MAAG,eAAE,EAAA4B,cAAY,gB,0BAO1D,EAAAK,W,wCAAZ,eAEM,SADF,eAA0C,GAAhCC,YAAY,gBAGiB,EAAAD,Y,iBAA/C,eAGM,MAHN,EAGM,CAFW,EAAAE,S,iBACb,eAAgE,Q,MAAlD,QAAK,8BAAE,EAAAC,WAAA,EAAAA,UAAA,qBAAWpC,MAAM,YAAW,c,iBADjD,eAAuE,Q,MAAhD,QAAK,8BAAE,EAAAoC,WAAA,EAAAA,UAAA,qBAAWpC,MAAM,YAAW,c,wBAKI,EAAAiC,W,kCAAtE,eAA6F,G,MAAlF,OAAM,EAAAI,KAAMrC,MAAM,a,8BAAoB,EAAAsC,iB,2CAErD,eAIM,MAJN,EAIM,CAHU,EAAAL,W,wCAAZ,eAEM,SADF,eAA6C,GAAnCC,YAAY,yB,6IAmBvB,GACXnB,KAAM,WACNwB,WAAY,CACRC,UAAA,MAEJC,MALW,WAOP,IAAMC,EAAS,iBACTC,EAAQ,iBAGRtC,EAAc,gBAAI,GAClBuC,EAAU,eAAS,CACrB5B,iBAAiB,EACjBiB,YAAY,IAIVY,EAAQ,eAAS,CACnBC,MAAO,CAACC,KAAM,EAAGC,KAAM,IACvBtB,MAAO,CAACqB,KAAM,EAAGC,KAAM,IACvBrB,eAAgB,CAACoB,KAAM,EAAGC,KAAM,MAIhCV,EAAgB,gBAAI,GACpBW,EAAiB,gBAAI,GACrBd,EAAU,gBAAI,GAGdvB,EAAa,eAAI,SACjBgB,EAAe,eAAI,KACnBI,EAAc,eAAI,KAGlBtB,EAAa,eAAI,IAEjBwC,EAAe,eAAI,IAEnBC,EAAuB,eAAI,IAC3BC,EAAwB,eAAI,IAC5BC,EAA6B,eAAI,IAEjCC,EAAe,eAAI,SACnBC,EAAc,eAAI,IAClBC,EAAiB,gBAAI,GACrB7C,EAAU,eAAI,IAGlB,gBAAU,WAGN,IAAI8C,EAAuB,OAAUC,QAAQ,CACzCC,YAAY,EACZC,KAAM,WACNC,OAAQ,2BAEZ,iBAAcC,MAAK,SAAAC,GACfb,EAAac,MAAQD,EAAIE,WACzBC,QAAQC,IAAI,sBAAuBJ,GAC/Bb,EAAac,MAAMI,OAAS,GAC5BlB,EAAac,MAAMK,SAAQ,SAACnD,GAEC,IAArBA,EAAKH,KAAKqD,SACVhB,EAAsBY,MAAMvD,KAAKS,EAAKH,MAEtCG,EAAKoD,SAASD,SAAQ,SAACE,GACS,IAAxBA,EAAQxD,KAAKqD,QACbjB,EAAqBa,MAAMvD,KAAK8D,EAAQxD,aAMtB,IAA9BmC,EAAac,MAAMI,SACnBxB,EAAQ5B,iBAAkB,EAC0B,MAAhDwD,OAAOC,aAAaC,QAAQ,oBAA4BF,OAAOC,aAAaC,QAAQ,mBAAmBN,OAAS,EAChH1D,EAAWsD,MAAQQ,OAAOC,aAAaC,QAAQ,mBAE/ChE,EAAWsD,MAAQrB,EAAMgC,MAAMC,WAEnCC,MAMJ,OAAUC,MAAM,cAErBC,OAAM,SAAAC,GACLd,QAAQC,IAAI,qBAAsBa,GAClC,OAAUF,MAAM,iBAES,OAAzBrB,IACAA,EAAqBwB,QACrBxB,EAAuB,SAK/B,IAAMoB,EAAiB,WAEnBX,QAAQC,IAAI,iBAAkBzD,EAAWsD,OAEzCT,EAAYS,MAAQtD,EAAWsD,MAG/BT,EAAYS,MAAQT,EAAYS,MAAMkB,cACtC,IAAIC,EAAO,EACXxE,EAAQqD,MAAQ,GAChBZ,EAAsBY,MAAMK,SAAQ,SAACnD,EAAMkE,GACvC,IACI,IAkBsB,EAlBlBC,EAAMnC,EAAac,MAAMoB,GAAOd,SAAWpB,EAAac,MAAMoB,GAAOd,SAAW,GAChFgB,GAAc,EACdC,EAAO,GAEX,IAAuD,IAAnDhC,EAAYS,MAAMwB,QAAQtE,EAAKgE,gBAc/B,GAbAG,EAAIhB,SAAQ,SAACE,EAASkB,GAClB,IAAIC,EAAMxC,EAAac,MAAMoB,GAAOd,SAASmB,GAAUrE,IACQ,IAA3DmC,EAAYS,MAAMwB,QAAQjB,EAAQxD,KAAKmE,iBACvCI,GAAc,EACdjC,EAA2BW,MAAMvD,KAAKiF,GACT,IAAzB/E,EAAQqD,MAAMI,SACdzD,EAAQqD,MAAQO,EAAQxD,OAGhCwE,EAAK9E,KAAKiF,OAITJ,GACD,EAAAjC,EAA2BW,OAAMvD,KAAjC,QAAyC8E,GAC5B,IAATJ,IACAxE,EAAQqD,MAAQ9C,GACpBiE,SAKJE,EAAIhB,SAAQ,SAACE,EAASkB,GAClB,IAAIC,EAAMxC,EAAac,MAAMoB,GAAOd,SAASmB,GAAUrE,IACQ,IAA3DmC,EAAYS,MAAMwB,QAAQjB,EAAQxD,KAAKmE,iBACvC7B,EAA2BW,MAAMvD,KAAKiF,GACT,IAAzB/E,EAAQqD,MAAMI,SACdzD,EAAQqD,MAAQO,EAAQxD,KAAKmE,mBAK/C,MAAOS,GACLzB,QAAQC,IAAI,mBAG4B,IAA5Cd,EAA2BW,MAAMI,QACjCxB,EAAQX,YAAa,EACkB,IAAnCY,EAAMS,EAAaU,OAAOjB,OAC1BF,EAAMS,EAAaU,OAAOjB,KAAO,GAErC6C,KAEAhD,EAAQX,YAAa,GAKvBpB,EAAW,SAACgF,GACd1D,EAAQ6B,OAAQ,EAChBV,EAAaU,MAAQ6B,EAAIC,MAAM/E,KAG/BsC,EAA2BW,MAAQ,GACnCpB,EAAQX,YAAa,EACrBuB,EAAeQ,OAAQ,EACvBV,EAAaU,MAAQ,QACrBT,EAAYS,MAAQ,GACpBnB,EAAMC,MAAMC,KAAO,EACnBF,EAAMC,MAAME,KAAO,GACnBH,EAAMnB,MAAMqB,KAAO,EACnBF,EAAMnB,MAAMsB,KAAO,GACnBH,EAAMlB,eAAeoB,KAAO,EAC5BF,EAAMlB,eAAeqB,KAAO,GAC5BV,EAAc0B,OAAQ,EACtBf,EAAee,OAAQ,EACvB7B,EAAQ6B,OAAQ,EAEhBa,KAIE5D,EAAY,gBAAS,WACvB,OAA8C,IAA1C4B,EAAMS,EAAaU,OAAOhB,KAAKoB,QAG/BxB,EAAQX,YAAa,EACd,KAHPW,EAAQX,YAAa,EAKlBY,EAAMS,EAAaU,OAAOhB,SAK/B3B,EAAY,SAACD,GACfsB,EAAOjC,KAAK,CAACsF,KAAM,UAAWpB,MAAO,CAACvD,SAI1C,iBAAM,kBAAMuB,EAAMgC,MAAMC,cAAY,SAACoB,GAEjC,QAAaC,IAATD,EAAoB,CAGpB,IAAIE,EAAWF,GACiB,IAA7BE,EAASC,WAAW,OACnBD,EAAWE,mBAAmBF,IAElC1B,OAAOC,aAAa4B,QAAQ,kBAAmBH,GAE/CxF,EAAWsD,MAAQkC,EAEnBhC,QAAQC,IAAI,QAAQ6B,GAEpB3C,EAA2BW,MAAQ,GACnCpB,EAAQX,YAAa,EACrBuB,EAAeQ,OAAQ,EACvBV,EAAaU,MAAQ,QACrBT,EAAYS,MAAQ,GACpBnB,EAAMC,MAAMC,KAAO,EACnBF,EAAMC,MAAME,KAAO,GACnBH,EAAMnB,MAAMqB,KAAO,EACnBF,EAAMnB,MAAMsB,KAAO,GACnBH,EAAMlB,eAAeoB,KAAO,EAC5BF,EAAMlB,eAAeqB,KAAO,GAC5BV,EAAc0B,OAAQ,EACtBf,EAAee,OAAQ,EACvB7B,EAAQ6B,OAAQ,EAEhBa,QAMR,IAAEL,QAAQ8B,QAAO,WAITC,KAAKC,KAAK,IAAEC,UAAUC,cAAgB,IAAED,UAAUE,SAAW,IAAEnC,QAAQmC,UACvE1D,EAAee,MAAQ1B,EAAc0B,OAAQ,EAC7C4B,MAEA3C,EAAee,OAAQ,EACnB,IAAEyC,UAAUC,YAAc,IAAElC,QAAQmC,SACpCrE,EAAc0B,OAAQ,EAEtB1B,EAAc0B,OAAQ,MAMlC,IAAM4B,EAAiB,WAEnB,IAAM7C,EAAOF,EAAMS,EAAaU,OAAOjB,KAAO,EAE9C,GAAgD,IAA5CM,EAA2BW,MAAMI,SAAyC,IAAzBZ,EAAeQ,MAAiB,CACjF,IAAI4C,EAAkB,MACO,IAAzB3D,EAAee,QACf4C,EAAkB,OAAUlD,QAAQ,CAACC,YAAY,EAAOC,KAAM,KAAMC,OAAQ,gBAEhF,IAAIgD,EAAS,EACTC,EAAgBzD,EAA2BW,MAAMI,OAErDf,EAA2BW,MAAMK,SAAQ,SAAC0C,GAEtC,eAAiBzD,EAAaU,MAAO+C,EAAUhE,GAAMe,MAAK,SAAAC,GAAO,OAC7D,EAAAlB,EAAMS,EAAaU,OAAOhB,MAAKvC,KAA/B,uBAAuCsD,EAAIlB,MAAMmE,OAEnB,IAA1BjD,EAAIlB,MAAMmE,KAAK5C,QACfyC,IACIA,IAAWC,IACXtD,EAAeQ,OAAQ,EACvB,IAAE,aAAaiD,KAAK,YACpB,IAAE,aAAaC,IAAI,SACnB/E,EAAQ6B,OAAQ,IAGpBpB,EAAQX,YAAa,KAE1B8C,OAAM,SAAAC,GACLd,QAAQC,IAAI,YACZX,EAAeQ,OAAQ,EACvB,IAAE,aAAaiD,KAAK,YACpB,IAAE,aAAaC,IAAI,SACnB/E,EAAQ6B,OAAQ,KAKI,OAApB4C,IACAA,EAAgB3B,QAChB2B,EAAkB,SAG1B/D,EAAMS,EAAaU,OAAOjB,MAAQ,OAElC,IAAE,aAAakE,KAAK,YACpB,IAAE,aAAaC,IAAI,SACnB/E,EAAQ6B,OAAQ,GAMlB3B,EAAO,WAET,IAAE,aAAa8E,QAAQ,CAACT,UAAW,GAAI,KACvCpE,EAAc0B,MAAQf,EAAee,OAAQ,GAI3C5B,EAAY,WACTD,EAAQ6B,QACTf,EAAee,MAAQ1B,EAAc0B,OAAQ,EAC7C4B,MAIR,sCAAUhF,aAAaC,WAAUgC,QAAO5B,YAAWuB,UAAA,KAC/CF,gBAAeD,OAAMhB,YAAWe,YAChC/B,eAAgB,gBAAOuC,IAF3B,IAEqCT,UACjCP,eAAcI,cAAatB,aAAYC,c,iCCtavD,MAAMyG,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASC,KAErD,gB","file":"js/chunk-0f258040.8c94e02c.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Search.vue?vue&type=style&index=0&id=ed2eb084&lang=css\"","`\r\n<template>\r\n    <!--查询页内容-->\r\n    <div class=\"_search-box\">\r\n        <div v-if=\"!appearError\">\r\n            <!--面包屑导航栏-->\r\n            <div class=\"pl-2 pl-md-3 pl-lg-4 d-flex align-items-center \">\r\n                <el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n                    <el-breadcrumb-item :to=\"{ path: '/' }\">首页</el-breadcrumb-item>\r\n                    <el-breadcrumb-item @click=\"$router.push({ path: '/category'})\">搜索</el-breadcrumb-item>\r\n                    <el-breadcrumb-item>{{searchText}}</el-breadcrumb-item>\r\n                </el-breadcrumb>\r\n                <div class=\"marL mainKey justify-content-start ml-5\" style=\"font-size:15px;\">关键词:{{keyWord}}</div>\r\n            </div>\r\n            <!--排序标题栏-->\r\n            <div class=\"_tab-title mt-2 mt-md-3\" style=\" ;\">\r\n                <el-tabs v-model=\"activeName\" @tab-click=\"tabClick\">\r\n                    <el-tab-pane label=\"销量排序\" name=\"sales\"></el-tab-pane>\r\n                    <el-tab-pane label=\"价格排序\" name=\"price\"></el-tab-pane>\r\n                    <el-tab-pane label=\"评化排序\" name=\"comments_count\"></el-tab-pane>\r\n                </el-tabs>\r\n            </div>\r\n            <!--排序商品栏-->\r\n            <div v-if=\"init_categories\" class=\"_goods_item_container\">\r\n                <div class=\"_goods_item container-fluid\">\r\n                    <div class=\"row\">\r\n                        <div class=\"col-6 col-sm-4 col-md-3 col-lg-2\" v-for=\"item in showGoods\" :key=\"item.id\"\r\n                             @click=\"itemClick(item.id)\">\r\n                            <el-card :body-style=\" { padding: '0px' }\" class=\"my-1  mx-1\">\r\n                                <img :src=\"item.cover_url\" class=\"image w-100 img-thumbnail mt-1\"\r\n                                     style=\"max-width:95%;\"/>\r\n                                <div style=\"font-size:16px;\">\r\n                                    <div class=\"d-flex flex-column justify-content-center align-items-start py-2 px-0 px-md-1 px-md-1\">\r\n                                        <span class=\"pl-2 text-truncate font-weight-bold\" style=\"font-weight:bold;\">{{item.title}}</span>\r\n                                        <span class=\"py-1 text-truncate\"\r\n                                              style=\"font-size:12px\">{{item.updated_at}}</span>\r\n                                        <div class=\"ml-0\">\r\n                                            <span class=\"text-danger font-weight-bold\" style=\"font-size:18px;\">￥&nbsp;{{item.price+'.00'}}</span>&nbsp;\r\n                                            <small class=\"text-muted\"><s>{{item.price-2}}.00</s></small>\r\n                                        </div>\r\n                                    </div>\r\n                                    <hr class=\"text-success w-100 py-0 my-0\" size=\"2\" style=\"height:1px;\">\r\n                                    <div class=\"text-muted  px-0 px-md-1 px-lg-2  d-flex justify-content-end \"\r\n                                         style=\"font-size:10px;\">\r\n                                        <small class=\"py-0\">\r\n                                    <span v-if=\"item.comments_count>0\">\r\n                                        <el-rate v-model=\"myHigherRate\"\r\n                                                 disabled show-score\r\n                                                 text-color=\"#ff9900\"\r\n                                                 class=\"d-none d-sm-block\"\r\n                                        > </el-rate>\r\n                                        <span class=\"d-block d-sm-none px-3\">评分：{{myHigherRate}}</span>\r\n                                    </span>\r\n                                            <span v-else>\r\n                                        <el-rate v-model=\"myLowerRate\"\r\n                                                 disabled show-score\r\n                                                 text-color=\"#ff9900\"\r\n                                                 class=\"d-none d-sm-block\"\r\n                                        > </el-rate>\r\n                                        <span class=\"d-block d-sm-none px-3\">评分：{{myHigherRate}}</span>\r\n                                    </span>\r\n                                        </small>\r\n                                    </div>\r\n                                </div>\r\n                            </el-card>\r\n                        </div>\r\n                        <div v-if=\"!init_goods\">\r\n                            <el-empty description=\"商品暂无数据\"></el-empty>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"w-100 text-center mb-3 mt-2\" v-if=\"init_goods\">\r\n                        <span v-if=\"!isTotal\" @click=\"myRefresh\" class=\"add_more\">点击加载更多</span>\r\n                        <span v-else @click=\"myRefresh\" class=\"add_more\">已经加载完毕啦！</span>\r\n                    </div>\r\n                </div>\r\n                <!--退回顶部-->\r\n                <back-top @bTop=\"bTop\" class=\"myloading\" v-show=\"isShowBackTop\" v-if=\"init_goods\"></back-top>\r\n            </div>\r\n            <div v-else class=\"_goods_item_container\">\r\n                <div v-if=\"!init_goods\">\r\n                    <el-empty description=\"没有查找到相关书箱\"></el-empty>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div v-else>\r\n            <img src=\"~assets/images/404error.png\" alt=\"\">\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import $ from 'jquery';\r\n    import BackTop from \"components/common/backtop/BackTop.vue\";\r\n    import {getCategory, getCategoryGoods} from 'network/category';\r\n\r\n    import {ElLoading, ElMessage} from 'element-plus';\r\n    import {ref, reactive, toRefs, onMounted, computed, watch} from 'vue';\r\n    import {useRouter, useRoute} from 'vue-router';\r\n\r\n    export default {\r\n        name: \"Category\",\r\n        components: {\r\n            BackTop,\r\n        },\r\n        setup() {\r\n            // 获取路由\r\n            const router = useRouter();\r\n            const route = useRoute();\r\n\r\n            // 初始化检测数据\r\n            const appearError = ref(false);   // 检测页面是否为404\r\n            const init_ok = reactive({\r\n                init_categories: false,\r\n                init_goods: false\r\n            });\r\n\r\n            // 数据模型\r\n            const goods = reactive({\r\n                sales: {page: 1, list: []},\r\n                price: {page: 1, list: []},\r\n                comments_count: {page: 1, list: []},\r\n            });\r\n\r\n            // 显示回到顶部按钮\r\n            let isShowBackTop = ref(false);\r\n            let isArriveBottom = ref(false);\r\n            let isTotal = ref(false);\r\n\r\n            // 其它页面数据\r\n            let activeName = ref('sales');\r\n            let myHigherRate = ref(4.9);\r\n            let myLowerRate = ref(3.7);\r\n\r\n            // 输入框数据处理\r\n            let searchText = ref('');         // 输入框的查询数据\r\n\r\n            let t_categories = ref([]);         // 未处理的列表项数据，数组内包含对象[{name:'前端',children:{}}]\r\n\r\n            let totalChildCategories = ref([]);       // 包含所有可选的数据查询值，列表\r\n            let totalParentCategories = ref([]);      // 包含所有的大标题数据查询值\r\n            let currentAssociateCategories = ref([]);      // 当前所有有关的标题值\r\n\r\n            let currentOrder = ref('sales');  //当前的排序条件和分类ID\r\n            let tSearchText = ref('');        // 中间变量\r\n            let isTotalMesaage = ref(false);  // 确认是否加载完成\r\n            let keyWord = ref('');            //关键字：首个关键字\r\n\r\n\r\n            onMounted(() => {            //在相同的路由页面内，参数不同，路由不会跳转后，数据不会发生改变。\r\n\r\n                // 分类数据列表项\r\n                let loadingInstance_init = ElLoading.service({\r\n                    fullscreen: false,\r\n                    text: '加载页面中。。。',\r\n                    target: '._goods_item_container'\r\n                });\r\n                getCategory().then(res => {                                // 获取标题数据\r\n                    t_categories.value = res.categories;\r\n                    console.log('serch-category-data', res);\r\n                    if (t_categories.value.length > 0) {\r\n                        t_categories.value.forEach((item) => {                 // 获取大标题和小标题\r\n                            // 获取大标题的内容\r\n                            if (item.name.length !== 0) {             // 注意需要添加.value\r\n                                totalParentCategories.value.push(item.name);     //前沿\r\n                                // 获取小标题的内容\r\n                                item.children.forEach((subItem) => {\r\n                                    if (subItem.name.length !== 0) {\r\n                                        totalChildCategories.value.push(subItem.name);\r\n                                    }\r\n                                });\r\n                            }\r\n                        });\r\n\r\n                        if (t_categories.value.length !== 0) {          // 检测分类数据数据是否为空, 优先使用浏览器中保存的上一个数据\r\n                            init_ok.init_categories = true;\r\n                            if (window.localStorage.getItem(\"lastSearchWords\")!=null && window.localStorage.getItem(\"lastSearchWords\").length > 0) {\r\n                                searchText.value = window.localStorage.getItem(\"lastSearchWords\");\r\n                            } else {\r\n                                searchText.value = route.query.SearchText;\r\n                            }\r\n                            dealSearchText();                            // 处理当前的字符串,需要等待数据接收完后，开始进行数据处理               // 页面加载中...\r\n\r\n                        } else {\r\n                            //appearError.value = true;\r\n                        }\r\n                    } else {\r\n                        ElMessage.error('请求数据失败！');\r\n                    }\r\n                }).catch(err => {\r\n                    console.log('serch-category-err', err);\r\n                    ElMessage.error('请求数据失败！请重试');\r\n                });\r\n                if (loadingInstance_init !== null) {\r\n                    loadingInstance_init.close();                // 页面加载中...\r\n                    loadingInstance_init = null;\r\n                }\r\n            });\r\n\r\n            // 根据输入框的值，与全部的值标题值进行匹配\r\n            const dealSearchText = () => {\r\n                // 先判断在大标题中是否有相关的内容\r\n                console.log('search页面中的查询值是', searchText.value);\r\n\r\n                tSearchText.value = searchText.value;                         // 防止影响正常数据\r\n\r\n                // 在判断数据的时候，全部转换成小写\r\n                tSearchText.value = tSearchText.value.toLowerCase();\r\n                let sign = 0;\r\n                keyWord.value = '';      // 清空历史记录\r\n                totalParentCategories.value.forEach((item, index) => {         // 数据在前，索引在后\r\n                    try {\r\n                        var arr = t_categories.value[index].children ? t_categories.value[index].children : [];\r\n                        var haveSimilar = false;\r\n                        var arrT = [];\r\n                        // 当输入框含有大标题时        // 前端javascript     前端css      前端JAVASCRIPT   前端CSS\r\n                        if (tSearchText.value.indexOf(item.toLowerCase()) !== -1) {          // 大标题数组\r\n                            arr.forEach((subItem, subIndex) => {                    // 小标题数组,数据里面包含对象。\r\n                                var tId = t_categories.value[index].children[subIndex].id;\r\n                                if (tSearchText.value.indexOf(subItem.name.toLowerCase()) !== -1) {\r\n                                    haveSimilar = true;\r\n                                    currentAssociateCategories.value.push(tId);\r\n                                    if (keyWord.value.length === 0) {                    // ---首个关键字\r\n                                        keyWord.value = subItem.name;\r\n                                    }\r\n                                }\r\n                                arrT.push(tId)\r\n                            });\r\n\r\n                            // 如果小标题没有数据的话，则使用大标题下的所有小标题\r\n                            if (!haveSimilar) {\r\n                                currentAssociateCategories.value.push(...arrT);\r\n                                if (sign === 0)                                            // --- 只记录首个关键字。\r\n                                    keyWord.value = item;\r\n                                sign++;\r\n                            }\r\n                        } else {\r\n                            // 当没有大标题数据的时候，可能有小标题数据         css abccd      JavaScript1111\r\n\r\n                            arr.forEach((subItem, subIndex) => {                    // 小标题数组,数据里面包含对象。\r\n                                var tId = t_categories.value[index].children[subIndex].id;\r\n                                if (tSearchText.value.indexOf(subItem.name.toLowerCase()) !== -1) {\r\n                                    currentAssociateCategories.value.push(tId);\r\n                                    if (keyWord.value.length === 0) {                    // 首个关键字\r\n                                        keyWord.value = subItem.name.toLowerCase();\r\n                                    }\r\n                                }\r\n                            });\r\n                        }\r\n                    } catch (e) {\r\n                        console.log('出现异常，已经终止搜索')\r\n                    }\r\n                });\r\n                if (currentAssociateCategories.value.length !== 0) {\r\n                    init_ok.init_goods = true;             // 默认先加载第一个标题栏的数据\r\n                    if (goods[currentOrder.value].page === 1) {\r\n                        goods[currentOrder.value].page = 0;\r\n                    }\r\n                    getMoreMessage();\r\n                } else {\r\n                    init_ok.init_goods = false;\r\n                }\r\n            };\r\n\r\n            // 排序选项卡，获取排序类型\r\n            const tabClick = (tab) => {         //使用van-tabs 组件，不需要传入参\r\n                isTotal.value = false;\r\n                currentOrder.value = tab.props.name;\r\n                // 事件触发时，改变数据\r\n                // 清空会有干扰的数据\r\n                currentAssociateCategories.value = [];\r\n                init_ok.init_goods = false;\r\n                isTotalMesaage.value = false;\r\n                currentOrder.value = 'sales';\r\n                tSearchText.value = '';\r\n                goods.sales.page = 1;\r\n                goods.sales.list = [];\r\n                goods.price.page = 1;\r\n                goods.price.list = [];\r\n                goods.comments_count.page = 1;\r\n                goods.comments_count.list = [];\r\n                isShowBackTop.value = false;\r\n                isArriveBottom.value = false;\r\n                isTotal.value = false;\r\n\r\n                dealSearchText();                            // 处理当前的字符串\r\n            };\r\n\r\n            // 显示商品\r\n            const showGoods = computed(() => {\r\n                if (goods[currentOrder.value].list.length !== 0) {       // 检测商品数据是否为空\r\n                    init_ok.init_goods = true;\r\n                } else {\r\n                    init_ok.init_goods = false;\r\n                    return [];\r\n                }\r\n                return goods[currentOrder.value].list;\r\n            });\r\n\r\n\r\n            // 点击商品，跳转详情页\r\n            const itemClick = (id) => {\r\n                router.push({path: '/detail', query: {id}})\r\n            };\r\n\r\n            // 监听路由的变化，在当前页面搜索时，后出现数据不能及时刷新的情况\r\n            watch(() => route.query.SearchText, (newA) => {    // 通过watch监听数据的改变\r\n\r\n                if (newA !== undefined) {                   // 当搜索页面跳转其它页面时，也会触发这个监听器\r\n                    // 但其它页面跳转到当前搜索页面时，却不一定会触发\r\n                    // 清空会有干扰的数据\r\n                    var new_text = newA;\r\n                    if(new_text.startsWith('%') === true){\r\n                        new_text = decodeURIComponent(new_text);\r\n                    }\r\n                    window.localStorage.setItem(\"lastSearchWords\", new_text);\r\n\r\n                    searchText.value = new_text;\r\n\r\n                    console.log(\"路由在变化\",newA);\r\n\r\n                    currentAssociateCategories.value = [];\r\n                    init_ok.init_goods = false;\r\n                    isTotalMesaage.value = false;\r\n                    currentOrder.value = 'sales';\r\n                    tSearchText.value = '';\r\n                    goods.sales.page = 1;\r\n                    goods.sales.list = [];\r\n                    goods.price.page = 1;\r\n                    goods.price.list = [];\r\n                    goods.comments_count.page = 1;\r\n                    goods.comments_count.list = [];\r\n                    isShowBackTop.value = false;\r\n                    isArriveBottom.value = false;\r\n                    isTotal.value = false;\r\n\r\n                    dealSearchText();                            // 处理当前的字符串\r\n                    // 异步请求服务器api接口\r\n                }\r\n            });\r\n\r\n            // 监听窗口滚动事件\r\n            $(window).scroll(function () {\r\n                // console.log('滚动中。。。',$(document).scrollTop(), $(document).height() , $(window).height());\r\n                // $(document).height() 是总的文档高度\r\n                // $(window).height() 是视口的高度(与outerHighert相同)\r\n                if (Math.ceil($(document).scrollTop()) >= $(document).height() - $(window).height()) {\r\n                    isArriveBottom.value = isShowBackTop.value = true;\r\n                    getMoreMessage();              // 调用函数\r\n                } else {\r\n                    isArriveBottom.value = false;\r\n                    if ($(document).scrollTop() < $(window).height()) {\r\n                        isShowBackTop.value = false;\r\n                    } else {\r\n                        isShowBackTop.value = true;              // 在滑动超过一定高度的时候，必需显示\r\n                    }\r\n                }\r\n            });\r\n\r\n            // 下拉或点击”加载更多“ 添加更多数据\r\n            const getMoreMessage = () => {\r\n\r\n                const page = goods[currentOrder.value].page + 1;\r\n\r\n                if (currentAssociateCategories.value.length !== 0 && isTotalMesaage.value === false) {\r\n                    let loadingInstance = null;\r\n                    if (isArriveBottom.value === true)\r\n                        loadingInstance = ElLoading.service({fullscreen: false, text: '加载', target: '.myloading'});\r\n\r\n                    var tCount = 0;       // 标记错误的数量\r\n                    var lenCategories = currentAssociateCategories.value.length;\r\n                    // 所有数据的id\r\n                    currentAssociateCategories.value.forEach((item_cid) => {\r\n                        /*数据聚集在cid=0上*/\r\n                        getCategoryGoods(currentOrder.value, item_cid, page).then(res => {\r\n                            goods[currentOrder.value].list.push(...res.goods.data);\r\n\r\n                            if (res.goods.data.length === 0) {                            // 数据加载完毕\r\n                                tCount++;\r\n                                if (tCount === lenCategories) {\r\n                                    isTotalMesaage.value = true;            // 数据已经全部加载完毕\r\n                                    $('.add_more').html('已经加载完毕啦！');\r\n                                    $(\".add_more\").off(\"click\");                     // 解绑点击事件,没效果\r\n                                    isTotal.value = true;\r\n                                }\r\n                            } else {\r\n                                init_ok.init_goods = true;\r\n                            }\r\n                        }).catch(err => {                    // 默认请求数据异常时，中断数据请求\r\n                            console.log('当前请求数据异常');\r\n                            isTotalMesaage.value = true;            // 数据已经全部加载完毕\r\n                            $('.add_more').html('已经加载完毕啦！');\r\n                            $(\".add_more\").off(\"click\");                     // 解绑点击事件,没效果\r\n                            isTotal.value = true;\r\n                            // ElMessage.error('请求数据失败！');\r\n                            //loadingInstance.close();                                   // 等待数据刷新。。。\r\n                        });\r\n\r\n                        if (loadingInstance !== null) {\r\n                            loadingInstance.close();\r\n                            loadingInstance = null;\r\n                        }\r\n                    });\r\n                    goods[currentOrder.value].page += 1;\r\n                } else {\r\n                    $('.add_more').html('已经加载完毕啦！');\r\n                    $(\".add_more\").off(\"click\");                     // 解绑点击事件,没效果\r\n                    isTotal.value = true;\r\n                }\r\n            };\r\n\r\n\r\n            // 退回顶部\r\n            const bTop = () => {\r\n                // 500毫秒内，滚动到顶部\r\n                $('body,html').animate({scrollTop: 0}, 200);//回到顶端\r\n                isShowBackTop.value = isArriveBottom.value = false;\r\n            };\r\n\r\n            // 点击”加载更多“\r\n            const myRefresh = () => {\r\n                if (!isTotal.value) {\r\n                    isArriveBottom.value = isShowBackTop.value = true;\r\n                    getMoreMessage();\r\n                }\r\n            };\r\n\r\n            return {  activeName,  tabClick, goods, showGoods, BackTop,\r\n                isShowBackTop, bTop, itemClick, myRefresh,\r\n                appearError, ...toRefs(init_ok), isTotal,\r\n                myHigherRate, myLowerRate, searchText, keyWord\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style>\r\n    /*.marL{\r\n        margin-left:40px;\r\n    }*/\r\n    .el-breadcrumb__item {\r\n        max-width: 80px !important;\r\n        overflow: hidden !important;\r\n        text-overflow: ellipsis;\r\n        white-space: nowrap;\r\n    }\r\n\r\n    .el-breadcrumb {\r\n        padding-left: 10px;\r\n    }\r\n\r\n    .el-tag {\r\n        float: left;\r\n    }\r\n\r\n    .el-tabs__nav-wrap {\r\n        display: flex;\r\n        justify-content: start;\r\n        padding-left: 30px;\r\n    }\r\n\r\n    .el-tabs__nav {\r\n        max-width: 700px;\r\n        display: flex;\r\n        padding: 0 20px;\r\n        justify-content: space-around;\r\n        align-items: center;\r\n    }\r\n\r\n    ._search-box{\r\n        position: relative;\r\n        min-height:540px;\r\n    }\r\n    ._list-item div span:hover, ._list-item div span.active {\r\n        background: red;\r\n        border-radius: 20px;\r\n        border: 1px solid lime;\r\n        color: white;\r\n    }\r\n\r\n    .add_more:hover {\r\n        color: red;\r\n    }\r\n</style>`","import { render } from \"./Search.vue?vue&type=template&id=ed2eb084\"\nimport script from \"./Search.vue?vue&type=script&lang=js\"\nexport * from \"./Search.vue?vue&type=script&lang=js\"\n\nimport \"./Search.vue?vue&type=style&index=0&id=ed2eb084&lang=css\"\n\nimport exportComponent from \"C:\\\\wamp64\\\\www\\\\giteeWarehouse\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}